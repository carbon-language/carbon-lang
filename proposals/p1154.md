# Destructors

<!--
Part of the Carbon Language project, under the Apache License v2.0 with LLVM
Exceptions. See /LICENSE for license information.
SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
-->

[Pull request](https://github.com/carbon-language/carbon-lang/pull/1154)

<!-- toc -->

## Table of contents

-   [Problem](#problem)
-   [Background](#background)
-   [Proposal](#proposal)
-   [Rationale based on Carbon's goals](#rationale-based-on-carbons-goals)
-   [Alternatives considered](#alternatives-considered)

<!-- tocstop -->

## Problem

C++ code supports defining custom
[destructors](<https://en.wikipedia.org/wiki/Destructor_(computer_programming)>)
for user-defined types, and C++ developers will expect to use that tool. Carbon
should support destructors, but should make some changes to protect against
deleting a value with a derived type through a pointer to the base class when
the base class destructor is not virtual. We also need some mechanism to allow
generic code to identify types that are safe to destroy, or have trivial
destructors and don't need to be explicitly destroyed.

## Background

Destructors may only be customized for nominal classes, which were introduced in
proposal [#722](https://github.com/carbon-language/carbon-lang/pull/722).
Destructors interact with inheritance, which was introduced in proposal
[#777](https://github.com/carbon-language/carbon-lang/pull/777).

## Proposal

This proposal adds two sections to the design:

-   ["Destructors"](/docs/design/classes.md#destructors) to the
    [classes design](/docs/design/classes.md), and
-   ["Destructor constraint"](/docs/design/generics/details.md#destructor-constraints)
    to the [detailed generics design](/docs/design/generics/details.md).

## Rationale based on Carbon's goals

TODO: How does this proposal effectively advance Carbon's goals? Rather than
re-stating the full motivation, this should connect that motivation back to
Carbon's stated goals for the project or language. This may evolve during
review. Use links to appropriate goals, for example:

-   [Community and culture](/docs/project/goals.md#community-and-culture)
-   [Language tools and ecosystem](/docs/project/goals.md#language-tools-and-ecosystem)
-   [Performance-critical software](/docs/project/goals.md#performance-critical-software)
-   [Software and language evolution](/docs/project/goals.md#software-and-language-evolution)
-   [Code that is easy to read, understand, and write](/docs/project/goals.md#code-that-is-easy-to-read-understand-and-write)
-   [Practical safety and testing mechanisms](/docs/project/goals.md#practical-safety-and-testing-mechanisms)
-   [Fast and scalable development](/docs/project/goals.md#fast-and-scalable-development)
-   [Modern OS platforms, hardware architectures, and environments](/docs/project/goals.md#modern-os-platforms-hardware-architectures-and-environments)
-   [Interoperability with and migration from existing C++ code](/docs/project/goals.md#interoperability-with-and-migration-from-existing-c-code)

## Alternatives considered

TODO: What alternative solutions have you considered?
