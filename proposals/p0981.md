# Implicit conversions for aggregates

<!--
Part of the Carbon Language project, under the Apache License v2.0 with LLVM
Exceptions. See /LICENSE for license information.
SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
-->

[Pull request](https://github.com/carbon-language/carbon-lang/pull/981)

<!-- toc -->

## Table of contents

-   [Problem](#problem)
-   [Background](#background)
-   [Proposal](#proposal)
-   [Details](#details)
-   [Rationale based on Carbon's goals](#rationale-based-on-carbons-goals)
-   [Alternatives considered](#alternatives-considered)

<!-- tocstop -->

## Problem

What operations are supported by default between two data classes with the same
fields in different orders? What implicit conversions are allowed between
aggregates, such as arrays, tuples, and data classes?

## Background

-   Comparison operators more generally were added to Carbon in
    [proposal #702: Comparison operators](https://github.com/carbon-language/carbon-lang/pull/702)
-   An initial take on these questions was originally in proposal
    [proposal #561: Basic classes: use cases, struct literals, struct types, and future work](https://github.com/carbon-language/carbon-lang/pull/561)
    but postponed until we had agreement on the right approach.
-   The discussion that eventually reached an agreement took place in
    [question-for-leads issue #710: Default comparison for data classes](https://github.com/carbon-language/carbon-lang/issues/710)

## Proposal

We propose that we should permissively allow operations between data classes and
other aggregates with different field orders and types where we can. Field order
in data classes is salient, but mostly determines the order that operations are
performed. The only case where different field orders will forbid an operation
is with ordering comparisons, where the field order determines the answer
returned, not just the order of execution.

## Details

Changes have been made to:

-   [docs/design/classes.md](/docs/design/classes.md),
-   [docs/design/tuples.md](/docs/design/tuples.md).

These changes are intended to apply to all aggregate types, including arrays.

## Rationale based on Carbon's goals

This proposal advances Carbon's goals:

-   [Software and language evolution](/docs/project/goals.md#software-and-language-evolution):
    This proposal allows changes to field order and type to be made
    incrementally.
-   [Code that is easy to read, understand, and write](/docs/project/goals.md#code-that-is-easy-to-read-understand-and-write):
    This proposal provides useful and expected facilities for data classes and
    other aggregate types by default

## Alternatives considered

TODO: What alternative solutions have you considered?
