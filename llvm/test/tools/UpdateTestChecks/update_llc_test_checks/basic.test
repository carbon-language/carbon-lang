# REQUIRES: x86-registered-target
## Basic test checking that update_llc_test_checks.py can update a file with multiple check prefixes

# RUN: cp -f %S/Inputs/basic.ll %t.ll && %update_llc_test_checks %t.ll
# RUN: echo '; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py' > %t.expected.ll
# RUN: cat %S/Inputs/basic.ll.expected >> %t.expected.ll
# RUN: diff -u %t.expected.ll %t.ll

## The flags --x86_scrub_rip and --extra_scrub should not have any effect on this
## test. Check the output is identical.
# RUN: cp -f %S/Inputs/basic.ll %t.ll && %update_llc_test_checks --extra_scrub %t.ll
# RUN: echo '; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --extra_scrub' > %t.expected.ll
# RUN: cat %S/Inputs/basic.ll.expected >> %t.expected.ll
# RUN: diff -u %t.expected.ll %t.ll
# RUN: cp -f %S/Inputs/basic.ll %t.ll && %update_llc_test_checks --x86_scrub_rip %t.ll
# RUN: echo '; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --x86_scrub_rip' > %t.expected.ll
# RUN: cat %S/Inputs/basic.ll.expected >> %t.expected.ll
# RUN: diff -u %t.expected.ll %t.ll

## Finally, run the script on an already updated file and verify that all previous
## CHECK lines are removed.
# RUN: %update_llc_test_checks %t.ll
# RUN: echo '; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --x86_scrub_rip' > %t.expected.ll
# RUN: cat %S/Inputs/basic.ll.expected >> %t.expected.ll
# RUN: diff -u %t.expected.ll %t.ll
