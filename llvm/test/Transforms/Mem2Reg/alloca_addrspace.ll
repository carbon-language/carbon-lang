; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt < %s -passes=mem2reg -S | FileCheck %s

; Do not crash ;)

target datalayout = "e-p:64:64-p5:32:32-A5"

define amdgpu_kernel void @addressspace_alloca() {
; CHECK-LABEL: @addressspace_alloca(
; CHECK-NEXT:    ret void
;
  %alloca = alloca i8, align 8, addrspace(5)
  %cast = addrspacecast i8 addrspace(5)* %alloca to i8*
  call void @llvm.lifetime.start.p0i8(i64 2, i8* %cast)
  ret void
}

declare void @llvm.lifetime.start.p0i8(i64 %size, i8* nocapture %ptr)
