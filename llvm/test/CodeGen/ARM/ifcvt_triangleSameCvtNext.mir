# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
# RUN: llc -mtriple=thumbv7-apple-ios -run-pass=if-converter -verify-machineinstrs %s -o - | FileCheck %s

# Both branches in bb.3 jump to bb.1. IfConversion shouldn't treat this as a
# tringle and insert the tADDspi in bb3, but leave it as it is.

...
---
name:            foo
body:             |
  ; CHECK-LABEL: name: foo
  ; CHECK: bb.0:
  ; CHECK:   successors: %bb.2(0x40000000), %bb.1(0x40000000)
  ; CHECK:   tBcc %bb.2, 1 /* CC::ne */, $cpsr
  ; CHECK: bb.1:
  ; CHECK:   successors: %bb.1(0x80000000)
  ; CHECK:   $sp = tADDspi $sp, 2, 14 /* CC::al */, $noreg
  ; CHECK:   tB %bb.1, 14 /* CC::al */, $noreg
  ; CHECK: bb.2:
  ; CHECK:   successors: %bb.3(0x40000000), %bb.2(0x40000000)
  ; CHECK:   tBcc %bb.3, 0 /* CC::eq */, $cpsr
  ; CHECK:   tB %bb.2, 14 /* CC::al */, $noreg
  ; CHECK: bb.3:
  ; CHECK:   successors: %bb.1(0x80000000)
  ; CHECK:   tBcc %bb.1, 1 /* CC::ne */, $cpsr
  ; CHECK:   tB %bb.1, 14 /* CC::al */, $noreg
  bb.0:
    tBcc %bb.2, 1, $cpsr

  bb.1:
    $sp = tADDspi $sp, 2, 14, _
    tB %bb.1, 14, $noreg

  bb.2:
    tBcc %bb.3, 0, $cpsr
    tB %bb.2, 14, $noreg

  bb.3:
    tBcc %bb.1, 1, $cpsr
    tB %bb.1, 14, $noreg
...
