; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -verify-machineinstrs -mcpu=pwr9 \
; RUN:   -mtriple=powerpc64le-unknown-linux-gnu < %s | FileCheck %s

; Ensure we don't crash by trying to convert directly from a subword load
; to a ppc_fp128 as we do for conversions to f32/f64.
define ppc_fp128 @test(i16* nocapture readonly %Ptr) {
; CHECK-LABEL: test:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    lhz 3, 0(3)
; CHECK-NEXT:    xxlxor 2, 2, 2
; CHECK-NEXT:    stw 3, -4(1)
; CHECK-NEXT:    addi 3, 1, -4
; CHECK-NEXT:    lfiwzx 0, 0, 3
; CHECK-NEXT:    xscvuxddp 1, 0
; CHECK-NEXT:    blr
entry:
  %0 = load i16, i16* %Ptr, align 2
  %conv = uitofp i16 %0 to ppc_fp128
  ret ppc_fp128 %conv
}
