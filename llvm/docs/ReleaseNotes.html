<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
                      "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="llvm.css" type="text/css">
  <title>LLVM 2.4 Release Notes</title>
</head>
<body>

<div class="doc_title">LLVM 2.4 Release Notes</div>

<ol>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#changes">Major Changes and Sub-project Status</a></li>
  <li><a href="#whatsnew">What's New?</a></li>
  <li><a href="GettingStarted.html">Installation Instructions</a></li>
  <li><a href="#portability">Portability and Supported Platforms</a></li>
  <li><a href="#knownproblems">Known Problems</a>
  <li><a href="#additionalinfo">Additional Information</a></li>
</ol>

<div class="doc_author">
  <p>Written by the <a href="http://llvm.org">LLVM Team</a><p>
</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="intro">Introduction</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>This document contains the release notes for the LLVM compiler
infrastructure, release 2.4.  Here we describe the status of LLVM, including
major improvements from the previous release and any known problems.  All LLVM
releases may be downloaded from the <a href="http://llvm.org/releases/">LLVM
releases web site</a>.</p>

<p>For more information about LLVM, including information about the latest
release, please check out the <a href="http://llvm.org/">main LLVM
web site</a>.  If you have questions or comments, the <a
href="http://mail.cs.uiuc.edu/mailman/listinfo/llvmdev">LLVM developer's mailing
list</a> is a good place to send them.</p>

<p>Note that if you are reading this file from a Subversion checkout or the
main LLVM web page, this document applies to the <i>next</i> release, not the
current one.  To see the release notes for a specific releases, please see the
<a href="http://llvm.org/releases/">releases page</a>.</p>

</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="changes">Major Changes and Sub-project Status</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>This is the fifteenth public release of the LLVM Compiler Infrastructure.
It includes a large number of features and refinements from LLVM 2.3.</p>

</div>

<!-- Unfinished features in 2.4:
  Machine LICM
  Machine Sinking
  LegalizeDAGTypes
  llc -enable-value-prop, propagation of value info (sign/zero ext info) from
       one MBB to another
 -->

 <!-- for announcement email:
    mention dev mtg
    Xcode 3.1 and 3.1.1.
  -->

<!--=========================================================================-->
<div class="doc_subsection">
<a name="changes">Major Changes in LLVM 2.4</a>
</div>

<div class="doc_text">

<p>The LLVM IR generated by llvm-gcc now doesn't name instructions.  Use the
   instnamer pass if you want them.</p>

<li>LoadVN and GCSE are completely gone.</li>


<p>LLVM API Changes:</p>

<ul>
<li>....</li>

<li>... Attributes changes ... </li>

<li>The <tt>DbgStopPointInst</tt> methods <tt>getDirectory</tt> and
<tt>getFileName</tt> now return <tt>Value*</tt> instead of strings. These can be
converted to strings using <tt>llvm::GetConstantStringInfo</tt> defined via
"llvm/Analysis/ValueTracking.h".</li>

<li>API change: BinaryOperator::create -> Create (CmpInst, CastInst too)</li>
<li>Various header files like "llvm/ADT/iterator" were given a .h suffix.
    Change your code to #include "llvm/ADT/iterator.h" instead.</li>

</ul>

</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="otherprojects">Other LLVM Sub-Projects</a>
</div>

<div class="doc_text">
<p>
The core LLVM 2.4 distribution currently consists of code from the core LLVM
repository (which roughly contains the LLVM optimizer, code generators and
supporting tools) and the llvm-gcc repository.  In addition to this code, the
LLVM Project includes other sub-projects that are in development.  The two which
are the most actively developed are the <a href="#clang">Clang Project</a> and
<a href="#vmkit">vmkit Project</a>.
</p>
</div>

<!--=========================================================================-->
<div class="doc_subsubsection">
<a name="vmkit">vmkit</a>
</div>

<div class="doc_text">
<p>
The <a href="http://vmkit.llvm.org/">"vmkit" project</a> is an implementation of
a JVM and a CLI Virtual Machines (Microsoft .NET is an
implementation of the CLI) using the Just-In-Time compiler of LLVM.</p>

<p>...</p>

</div>

<!--=========================================================================-->
<div class="doc_subsubsection">
<a name="clang">Clang</a>
</div>

<div class="doc_text">

<p>The <a href="http://clang.llvm.org/">Clang project</a> is an effort to build
a set of new 'LLVM native' front-end technologies for the LLVM optimizer
and code generator.  Clang is continuing to make major strides forward in all
areas.  Its C and Objective-C parsing support is very solid, and the code
generation support is far enough along to build many C applications.  While not
yet production quality, it is progressing very nicely.  In addition, C++
front-end work has started to make significant progress.</p>

<p>Codegen progress/state
</p>

<p>
<a href="http://clang.llvm.org/StaticAnalysis.html">static analysis tool</a>
</p>

</div>


<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="whatsnew">What's New?</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>LLVM 2.4 includes a huge number of bug fixes, performance tweaks and minor
improvements.  Some of the major improvements and new features are listed in
this section.
</p>
</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="majorfeatures">Major New Features</a>
</div>

<div class="doc_text">

<p>LLVM 2.4 includes several major new capabilities:</p>

<ul>
<li>
 <p>MRVs got generalized to FCAs.  getresult is gone, ret with multiple values
 is gone.</p>
 </li>

<li><p>-O0 compile times overall much faster</p></li>

<li><p>Attrs changes?</p></li>


<li><p>Initial PIC16 port</p></li>

<li><p> Support the rest of the atomic __sync builtins</p></li>

<li><p>...</p></li>

</ul>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="llvm-gcc">llvm-gcc 4.2 Improvements</a>
</div>

<div class="doc_text">

<p>LLVM 2.4 fully supports the llvm-gcc 4.2 front-end, and includes support
for the C, C++, Objective-C, Ada, and Fortran front-ends.</p>

<p>
<ul>
<li>...</li>

</ul>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="coreimprovements">LLVM Core Improvements</a>
</div>

<div class="doc_text">
<p>New features include:
</p>

<ul>
<li>vector shifts in the IR: no codegen support yet</li>
<li>use diet patch landed: saved 15% IR memory footprint</li>
<li>LLVM IR now directly represents "common" linkage, instead of
    representing it as a form of weak linkage.</li>
<li>DebugInfoBuilder</li>
<li>.ll printing format change: %3 = add i32 4, 2</li>
<li>...</li>
</ul>

</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="optimizer">Optimizer Improvements</a>
</div>

<div class="doc_text">

<p>In addition to a huge array of bug fixes and minor performance tweaks, the
LLVM 2.4 optimizers support a few major enhancements:</p>

<ul>

<li>GVN now does local PRE?</li>

<li>Matthijs' Dead argument elimination rewrite</li>

<li>Old-ADCE used control dependence and deleted output-free infinite loops.
Added a new Loop deletion pass (for deleting output free provably-finite loops)
and rewrote ADCE to be simpler faster, and not need control dependence.</li>

<li>SparsePropagation framework for lattice-based dataflow solvers.</li>

<li>Tail duplication was removed from the standard optimizer sequence.</li>

<li>Various helper functions (ComputeMaskedBits, ComputeNumSignBits, etc) were
pulled out of instcombine and put into a new ValueTracking.h file, where they
can be reused by other passes.</li>

<li>MarkModRef etc</li>
</ul>

</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="codegen">Code Generator Improvements</a>
</div>

<div class="doc_text">

<p>We put a significant amount of work into the code generator infrastructure,
which allows us to implement more aggressive algorithms and make it run
faster:</p>

<ul>
<li>asm writers split out to their own library to avoid JITs having to link
 them in.</li>
<li>Big asm writer refactoring + TargetAsmInfo</li>
<li>2-addr pass and coalescer can now remat trivial insts to avoid a copy.</li>
<li>spiller to commute instructions in order to fold a reload</li>
<li>Stack slot coloring?</li>
<li>Live intervals renumbering?  Is this useful to external people?</li>
<li>'is as cheap as a move' instruction flag</li>
<li>Improvements to selection dag viewing</li>
<li>fast isel</li>
<li>Selection dag speedups</li>
<li>asmwriter + raw_ostream -> fastah</li>
<li>...</li>

</ul>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="x86specific">X86/X86-64 Specific Improvements</a>
</div>

<div class="doc_text">
<p>New target-specific features include:
</p>

<ul>
<li>Exception handling is supported by default on Linux/x86-64.</li>
<li>Position Independent Code (PIC) is now support on Linux/x86-64.</li>
<li>...</li>

</ul>

</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="targetspecific">Other Target Specific Improvements</a>
</div>

<div class="doc_text">
<p>New target-specific features include:
</p>

<ul>
<li>MIPS floating point support?</li>
<li>....</li>
</ul>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="otherimprovements">Other Improvements</a>
</div>

<div class="doc_text">
<p>New features include:
</p>

<ul>
<li><tt>llvmc2</tt>(the generic compiler driver) gained plugin
  support. It is now easier to experiment with <tt>llvmc2</tt> and
  build your own tools based on it. </li>
<li>raw_ostream + formatting</li>
<li>Recycler + pool allocation stuff?</li>
<li>...</li>
</ul>

</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="portability">Portability and Supported Platforms</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>LLVM is known to work on the following platforms:</p>

<ul>
<li>Intel and AMD machines (IA32) running Red Hat Linux, Fedora Core and FreeBSD
      (and probably other unix-like systems).</li>
<li>PowerPC and X86-based Mac OS X systems, running 10.3 and above in 32-bit and
    64-bit modes.</li>
<li>Intel and AMD machines running on Win32 using MinGW libraries (native).</li>
<li>Intel and AMD machines running on Win32 with the Cygwin libraries (limited
    support is available for native builds with Visual C++).</li>
<li>Sun UltraSPARC workstations running Solaris 10.</li>
<li>Alpha-based machines running Debian GNU/Linux.</li>
<li>Itanium-based (IA64) machines running Linux and HP-UX.</li>
</ul>

<p>The core LLVM infrastructure uses GNU autoconf to adapt itself
to the machine and operating system on which it is built.  However, minor
porting may be required to get LLVM to work on new platforms.  We welcome your
portability patches and reports of successful builds or error messages.</p>

</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="knownproblems">Known Problems</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>This section contains all known problems with the LLVM system, listed by
component.  As new problems are discovered, they will be added to these
sections.  If you run into a problem, please check the <a
href="http://llvm.org/bugs/">LLVM bug database</a> and submit a bug if
there isn't already one.</p>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="experimental">Experimental features included with this release</a>
</div>

<div class="doc_text">

<p>The following components of this LLVM release are either untested, known to
be broken or unreliable, or are in early development.  These components should
not be relied on, and bugs should not be filed against them, but they may be
useful to some people.  In particular, if you would like to work on one of these
components, please contact us on the <a
href="http://lists.cs.uiuc.edu/mailman/listinfo/llvmdev">LLVMdev list</a>.</p>

<ul>
<li>The MSIL, IA64, Alpha, SPU, and MIPS backends are experimental.</li>
<li>The llc "<tt>-filetype=asm</tt>" (the default) is the only supported
    value for this option.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="x86-be">Known problems with the X86 back-end</a>
</div>

<div class="doc_text">

<ul>
  <li>The X86 backend does not yet support
    all <a href="http://llvm.org/PR879">inline assembly that uses the X86
    floating point stack</a>.  It supports the 'f' and 't' constraints, but not
    'u'.</li>
  <li>The X86 backend generates inefficient floating point code when configured
    to generate code for systems that don't have SSE2.</li>
  <li>Win64 code generation wasn't widely tested. Everything should work, but we
    expect small issues to happen. Also, llvm-gcc cannot build mingw64 runtime
    currently due
    to <a href="http://llvm.org/PR2255">several</a>
    <a href="http://llvm.org/PR2257">bugs</a> due to lack of support for the
    'u' inline assembly constraint and X87 floating point inline assembly.</li>
  <li>The X86-64 backend does not yet support the LLVM IR instruction
      <tt>va_arg</tt>. Currently, the llvm-gcc front-end supports variadic
      argument constructs on X86-64 by lowering them manually.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="ppc-be">Known problems with the PowerPC back-end</a>
</div>

<div class="doc_text">

<ul>
<li>The Linux PPC32/ABI support needs testing for the interpreter and static
compilation, and lacks support for debug information.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="arm-be">Known problems with the ARM back-end</a>
</div>

<div class="doc_text">

<ul>
<li>Thumb mode works only on ARMv6 or higher processors. On sub-ARMv6
processors, thumb programs can crash or produce wrong
results (<a href="http://llvm.org/PR1388">PR1388</a>).</li>
<li>Compilation for ARM Linux OABI (old ABI) is supported, but not fully tested.
</li>
<li>There is a bug in QEMU-ARM (&lt;= 0.9.0) which causes it to incorrectly
 execute
programs compiled with LLVM.  Please use more recent versions of QEMU.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="sparc-be">Known problems with the SPARC back-end</a>
</div>

<div class="doc_text">

<ul>
<li>The SPARC backend only supports the 32-bit SPARC ABI (-m32), it does not
    support the 64-bit SPARC ABI (-m64).</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="alpha-be">Known problems with the Alpha back-end</a>
</div>

<div class="doc_text">

<ul>

<li>On 21164s, some rare FP arithmetic sequences which may trap do not have the
appropriate nops inserted to ensure restartability.</li>

</ul>
</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="ia64-be">Known problems with the IA64 back-end</a>
</div>

<div class="doc_text">

<ul>
<li>The Itanium backend is highly experimental, and has a number of known
    issues.  We are looking for a maintainer for the Itanium backend.  If you
    are interested, please contact the llvmdev mailing list.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="c-be">Known problems with the C back-end</a>
</div>

<div class="doc_text">

<ul>
<li><a href="http://llvm.org/PR802">The C backend has only basic support for
    inline assembly code</a>.</li>
<li><a href="http://llvm.org/PR1658">The C backend violates the ABI of common
    C++ programs</a>, preventing intermixing between C++ compiled by the CBE and
    C++ code compiled with llc or native compilers.</li>
<li>The C backend does not support all exception handling constructs.</li>
</ul>

</div>


<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="c-fe">Known problems with the llvm-gcc C front-end</a>
</div>

<div class="doc_text">

<p>llvm-gcc does not currently support <a href="http://llvm.org/PR869">Link-Time
Optimization</a> on most platforms "out-of-the-box".  Please inquire on the
llvmdev mailing list if you are interested.</p>

<p>The only major language feature of GCC not supported by llvm-gcc is
    the <tt>__builtin_apply</tt> family of builtins.   However, some extensions
    are only supported on some targets.  For example, trampolines are only
    supported on some targets (these are used when you take the address of a
    nested function).</p>

<p>If you run into GCC extensions which are not supported, please let us know.
</p>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="c++-fe">Known problems with the llvm-gcc C++ front-end</a>
</div>

<div class="doc_text">

<p>The C++ front-end is considered to be fully
tested and works for a number of non-trivial programs, including LLVM
itself, Qt, Mozilla, etc.</p>

<ul>
<li>Exception handling works well on the X86 and PowerPC targets. Currently
  only linux and darwin targets are supported (both 32 and 64 bit).</li>
</ul>

</div>


<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="ada-fe">Known problems with the llvm-gcc Ada front-end</a>
</div>

<div class="doc_text">
The llvm-gcc 4.2 Ada compiler works fairly well, however this is not a mature
technology and problems should be expected.
<ul>
<li>The Ada front-end currently only builds on X86-32.  This is mainly due
to lack of trampoline support (pointers to nested functions) on other platforms,
however it <a href="http://llvm.org/PR2006">also fails to build on X86-64</a>
which does support trampolines.</li>
<li>The Ada front-end <a href="http://llvm.org/PR2007">fails to bootstrap</a>.
Workaround: configure with --disable-bootstrap.</li>
<li>The c380004 and <a href="http://llvm.org/PR2010">c393010</a> ACATS tests
fail (c380004 also fails with gcc-4.2 mainline).  When built at -O3, the
<a href="http://llvm.org/PR2421">cxg2021</a> ACATS test also fails.</li>
<li>Some gcc specific Ada tests continue to crash the compiler.  The testsuite
reports most tests as having failed even though they pass.</li>
<li>The -E binder option (exception backtraces)
<a href="http://llvm.org/PR1982">does not work</a> and will result in programs
crashing if an exception is raised.  Workaround: do not use -E.</li>
<li>Only discrete types <a href="http://llvm.org/PR1981">are allowed to start
or finish at a non-byte offset</a> in a record.  Workaround: do not pack records
or use representation clauses that result in a field of a non-discrete type
starting or finishing in the middle of a byte.</li>
<li>The <tt>lli</tt> interpreter <a href="http://llvm.org/PR2009">considers
'main' as generated by the Ada binder to be invalid</a>.
Workaround: hand edit the file to use pointers for <tt>argv</tt> and
<tt>envp</tt> rather than integers.</li>
<li>The <tt>-fstack-check</tt> option <a href="http://llvm.org/PR2008">is
ignored</a>.</li>
</ul>
</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="additionalinfo">Additional Information</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>A wide variety of additional information is available on the <a
href="http://llvm.org">LLVM web page</a>, in particular in the <a
href="http://llvm.org/docs/">documentation</a> section.  The web page also
contains versions of the API documentation which is up-to-date with the
Subversion version of the source code.
You can access versions of these documents specific to this release by going
into the "<tt>llvm/doc/</tt>" directory in the LLVM tree.</p>

<p>If you have any questions or comments about LLVM, please feel free to contact
us via the <a href="http://llvm.org/docs/#maillist"> mailing
lists</a>.</p>

</div>

<!-- *********************************************************************** -->

<hr>
<address>
  <a href="http://jigsaw.w3.org/css-validator/check/referer"><img
  src="http://jigsaw.w3.org/css-validator/images/vcss" alt="Valid CSS!"></a>
  <a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01!"></a>

  <a href="http://llvm.org/">LLVM Compiler Infrastructure</a><br>
  Last modified: $Date$
</address>

</body>
</html>
