RUN: lld -core -target x86_64-linux %p/Inputs/use-shared.x86-64 \
RUN:   %p/Inputs/shared.so-x86-64 -output=%t -entry=main \
RUN:   -output-type=dynamic
RUN: lld -core -target x86_64-linux %p/Inputs/use-shared.x86-64 \
RUN:   %p/Inputs/shared.so-x86-64 -emit-yaml -output=%t2 -noinhibit-exec \
RUN:   -output-type=dynamic
RUN: llvm-objdump -p %t >> %t2
RUN: llvm-readobj %t >> %t2
RUN: FileCheck %s < %t2

CHECK: type: got
CHECK: R_X86_64_JUMP_SLOT

CHECK: name: main
CHECK: kind: R_X86_64_PC32
CHECK: target: [[PLTNAME:[-a-zA-Z0-9_]+]]

CHECK: name: [[PLTNAME]]
CHECK: type: stub

CHECK: shared-library-atoms:
CHECK: name: foo
CHECK: load-name: shared.so-x86-64

CHECK: PHDR off 0x{{0+}}40
CHECK: INTERP
CHECK: flags r--

CHECK: Dynamic Symbols:
CHECK:   foo FUNC {{[0-9a-f]+}} 0 {{[0-9a-f]+}} undef,global
CHECK:   i FUNC {{[0-9a-f]+}} 0 {{[0-9a-f]+}} undef,global
CHECK:   Total: 2

CHECK: Sections:
CHECK:   .hash {{[0-9a-f]+}} 20 8 required,rodata

CHECK: Dynamic section contains 14 entries
CHECK:   Tag                Type                 Name/Value
CHECK:  0x0000000000000004 (HASH)
CHECK:  0x0000000000000005 (STRTAB)
CHECK:  0x0000000000000006 (SYMTAB)
CHECK:  0x000000000000000a (STRSZ)
CHECK:  0x000000000000000b (SYMENT) 24
CHECK:  0x0000000000000007 (RELA)
CHECK:  0x0000000000000008 (RELASZ) 24
CHECK:  0x0000000000000009 (RELAENT) 24
CHECK:  0x0000000000000002 (PLTRELSZ) 24
CHECK:  0x0000000000000003 (PLTGOT)
CHECK:  0x0000000000000014 (PLTREL) RELA
CHECK:  0x0000000000000017 (JMPREL)
CHECK:  0x0000000000000001 (NEEDED) Shared library: [shared.so-x86-64]
CHECK:  0x0000000000000000 (NULL)               0x0
CHECK:   Total: 14
