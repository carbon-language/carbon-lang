name: 'Auto Assign'
on:
  pull_request:
    types: [opened, ready_for_review]

jobs:
  assign_reviewer:
    runs-on: ubuntu-latest
    steps:
      - id: path-filter
        uses: dorny/paths-filter@v2
        with:
          filters: |
            leads: 'proposals/*.md'
            explorer: 'explorer/**'
            toolchain: 'toolchain/**'

      - id: assign-leads
        if: steps.changes.outputs.leads == 'true'
        uses: shufo/auto-assign-reviewer-by-files@v1.1.3
        with:
          configuration-path: '.github/assign_prs/leads.yaml'

      - id: assign-explorer
        if: steps.changes.outputs.explorer == 'true'
        uses: shufo/auto-assign-reviewer-by-files@v1.1.3
        with:
          configuration-path: '.github/assign_prs/explorer.yaml'

      - id: assign-toolchain
        if: steps.changes.outputs.toolchain == 'true'
        uses: shufo/auto-assign-reviewer-by-files@v1.1.3
        with:
          configuration-path: '.github/assign_prs/toolchain.yaml'

      - id: assign-fallback
        if:
          steps.changes.outputs.leads != 'true' &&
          steps.changes.outputs.explorer != 'true' &&
          steps.changes.outputs.toolchain != 'true'
        uses: shufo/auto-assign-reviewer-by-files@v1.1.3
        with:
          configuration-path: '.github/assign_prs/fallback.yaml'
