# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
# RUN: llc -mtriple=amdgcn-amd-amdhsa -mcpu=gfx1031 -verify-machineinstrs -run-pass=postrapseudos -o - %s | FileCheck %s

# The copy has an implicit def of a superregister which overlaps the
# register it defines. We cannot preserve the kill on the tuple def
# when copying implicit operands to the last inserted v_mov_b32, since
# it kills the subregister defined earlier in the expansion.

---
name: copy_has_implicit_kill_superreg
tracksRegLiveness: true
body:             |
  bb.0:

    ; CHECK-LABEL: name: copy_has_implicit_kill_superreg
    ; CHECK: renamable $vgpr7_vgpr8_vgpr9_vgpr10 = IMPLICIT_DEF
    ; CHECK-NEXT: $vgpr7 = V_MOV_B32_e32 $vgpr10, implicit $exec, implicit-def $vgpr7_vgpr8, implicit $vgpr10_vgpr11
    ; CHECK-NEXT: $vgpr8 = V_MOV_B32_e32 $vgpr11, implicit $exec, implicit killed $vgpr10_vgpr11, implicit $vgpr7_vgpr8_vgpr9_vgpr10
    ; CHECK-NEXT: S_ENDPGM 0, implicit $vgpr7
    renamable $vgpr7_vgpr8_vgpr9_vgpr10 = IMPLICIT_DEF
    renamable $vgpr7_vgpr8 = COPY killed renamable $vgpr10_vgpr11, implicit killed $vgpr7_vgpr8_vgpr9_vgpr10
    S_ENDPGM 0, implicit $vgpr7

...
