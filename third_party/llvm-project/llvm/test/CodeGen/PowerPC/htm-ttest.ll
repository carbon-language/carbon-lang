; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -mtriple=powerpc64le-unknown-linux-gnu -verify-machineinstrs \
; RUN:     -mcpu=pwr8 -mattr=+htm < %s | FileCheck %s

define dso_local void @main() #0 {
; CHECK-LABEL: main:
; CHECK:       # %bb.0:
; CHECK-NEXT:    li 3, 0
; CHECK-NEXT:    tabortwci. 0, 3, 0
; CHECK-NEXT:    mfocrf 3, 128
; CHECK-NEXT:    srwi 3, 3, 28
; CHECK-NEXT:    rlwinm. 3, 3, 31, 30, 31
; CHECK-NEXT:    beqlr+ 0
; CHECK-NEXT:  # %bb.1:
  %1 = call i64 @llvm.ppc.ttest() #1
  %2 = lshr i64 %1, 1
  %3 = and i64 %2, 3
  %4 = icmp eq i64 %3, 0
  br i1 %4, label %5, label %6

5:                                                ; preds = %0
  ret void

6:                                                ; preds = %0
  unreachable
}

; Function Attrs: nounwind
declare i64 @llvm.ppc.ttest() #1

