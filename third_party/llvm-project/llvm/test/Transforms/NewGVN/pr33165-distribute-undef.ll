; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -passes=newgvn -S %s | FileCheck %s

; Test for PR33165.

define i2 @f(i2, i1) {
; CHECK-LABEL: @f(
; CHECK-NEXT:    [[A:%.*]] = xor i2 [[TMP0:%.*]], -1
; CHECK-NEXT:    [[B:%.*]] = select i1 [[TMP1:%.*]], i2 [[A]], i2 undef
; CHECK-NEXT:    [[C:%.*]] = and i2 [[A]], [[B]]
; CHECK-NEXT:    ret i2 [[C]]
;
  %a = xor i2 %0, -1
  %b = select i1 %1, i2 %a, i2 undef
  %c = and i2 %a, %b
  ret i2 %c
}
