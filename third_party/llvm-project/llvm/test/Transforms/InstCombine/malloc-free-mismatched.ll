; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt < %s -instcombine -S | FileCheck %s

define dso_local i32 @_Z6answeri(i32 %0) {
; CHECK-LABEL: @_Z6answeri(
; CHECK-NEXT:    [[TMP2:%.*]] = call noalias nonnull dereferenceable(80) i8* @_Znam(i64 80) #[[ATTR1:[0-9]+]]
; CHECK-NEXT:    call void @free(i8* [[TMP2]])
; CHECK-NEXT:    ret i32 42
;
  %2 = call noalias nonnull i8* @_Znam(i64 80) #0
  call void @free(i8* %2)
  ret i32 42
}

; All we care about with this function is that LLVM doesn't crash
; when optimizing it.
define void @test_alloca() {
  %1 = alloca i8
  call void @free(i8* %1)
  ret void
}

; Function Attrs: nobuiltin allocsize(0)
declare dso_local nonnull i8* @_Znam(i64) #1

; Function Attrs: nounwind
declare dso_local void @free(i8*)

attributes #0 = { builtin allocsize(0) }
attributes #1 = { nobuiltin allocsize(0) }
