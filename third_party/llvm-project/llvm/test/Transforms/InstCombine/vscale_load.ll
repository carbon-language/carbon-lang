; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt < %s -instcombine -S -verify | FileCheck %s

define <2 x i8> @constprop_load_bitcast(<vscale x 16 x i1>* %ptr) {
; CHECK-LABEL: @constprop_load_bitcast(
; CHECK-NEXT:    store <vscale x 16 x i1> zeroinitializer, <vscale x 16 x i1>* [[PTR:%.*]], align 16
; CHECK-NEXT:    ret <2 x i8> zeroinitializer
;
  store <vscale x 16 x i1> zeroinitializer, <vscale x 16 x i1>* %ptr, align 16
  %cast_to_fixed = bitcast <vscale x 16 x i1>* %ptr to <2 x i8>*
  %a = load <2 x i8>, <2 x i8>* %cast_to_fixed, align 16
  ret <2 x i8> %a
}

; vscale-sized vec not guaranteed to fill destination.
define <8 x i8> @constprop_load_bitcast_neg(<vscale x 16 x i1>* %ptr) {
; CHECK-LABEL: @constprop_load_bitcast_neg(
; CHECK-NEXT:    store <vscale x 16 x i1> zeroinitializer, <vscale x 16 x i1>* [[PTR:%.*]], align 16
; CHECK-NEXT:    [[CAST_TO_FIXED:%.*]] = bitcast <vscale x 16 x i1>* [[PTR]] to <8 x i8>*
; CHECK-NEXT:    [[A:%.*]] = load <8 x i8>, <8 x i8>* [[CAST_TO_FIXED]], align 16
; CHECK-NEXT:    ret <8 x i8> [[A]]
;
  store <vscale x 16 x i1> zeroinitializer, <vscale x 16 x i1>* %ptr, align 16
  %cast_to_fixed = bitcast <vscale x 16 x i1>* %ptr to <8 x i8>*
  %a = load <8 x i8>, <8 x i8>* %cast_to_fixed, align 16
  ret <8 x i8> %a
}
