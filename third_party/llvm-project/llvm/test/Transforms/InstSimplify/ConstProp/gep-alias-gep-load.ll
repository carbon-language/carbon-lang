; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -passes=instsimplify -S < %s | FileCheck %s

@a1 = internal alias i32, getelementptr ({[3 x i32]}, ptr @b, i32 0, i32 0, i32 1)
@a2 = weak alias i32, getelementptr ({[3 x i32]}, ptr @b, i32 0, i32 0, i32 1)
@b = internal constant {[3 x i32]} {[3 x i32] [i32 2, i32 3, i32 4]}

@c = internal alias i32, getelementptr ({[3 x i32]}, ptr @d, i32 0, i32 0, i32 1)
@d = weak constant {[3 x i32]} {[3 x i32] [i32 2, i32 3, i32 4]}

define i32 @f() {
; CHECK-LABEL: @f(
; CHECK-NEXT:    ret i32 4
;
  %a = load i32, ptr getelementptr (i32, ptr @a1, i64 1)
  ret i32 %a
}

define i32 @g() {
; CHECK-LABEL: @g(
; CHECK-NEXT:    [[A:%.*]] = load i32, ptr getelementptr (i32, ptr @a2, i64 1), align 4
; CHECK-NEXT:    ret i32 [[A]]
;
  %a = load i32, ptr getelementptr (i32, ptr @a2, i64 1)
  ret i32 %a
}

define i32 @h() {
; CHECK-LABEL: @h(
; CHECK-NEXT:    [[A:%.*]] = load i32, ptr getelementptr (i32, ptr @c, i64 1), align 4
; CHECK-NEXT:    ret i32 [[A]]
;
  %a = load i32, ptr getelementptr (i32, ptr @c, i64 1)
  ret i32 %a
}
