<!DOCTYPE html>
<!--
Part of the Carbon Language, under the Apache License v2.0 with LLVM Exceptions.
See /LICENSE for license information.
SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
-->
<html>
<head>
  <title>Carbon: Login</title>
  <script src="/__/firebase/7.14.0/firebase-app.js"></script>
  <script src="/__/firebase/7.14.0/firebase-auth.js"></script>
  <script src="/__/firebase/init.js"></script>
  <script type="text/javascript">
    function login() {
      var provider = new firebase.auth.GithubAuthProvider();
      firebase.auth().signInWithPopup(provider).then(function(result) {
        var user = result.user;
        user.getIdToken(true).then(function(token) {
          document.cookie = '__session=' + token + ';max-age=25920000';
          window.location.href = window.location.href.replace(
              "/login.html", "/index.html");
        });
      });
    };

    firebase.auth().onAuthStateChanged(function(user) {
      // If there's no user, we can redirect.
      if (!user) redirect();
    });

    window.onload = function() {
      document.cookie = "__session=; expires=Thu, 01 Jan 1970 00:00:00 GMT";
      firebase.auth().signOut();
    };
  </script>
</head>
<body>
<p>Currently logged out.</p>

<button onclick="login()">Log in using GitHub</button>
</body>
</html>
